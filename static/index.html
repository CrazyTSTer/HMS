<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Automated System of Logging Water and Electricity Meters Data</title>
    <!--------LOADING JQUERY LIBRARY---------------->
    <script src="static/js/jquery-3.3.1.min.js"></script>

    <!--------LOADING POPPER LIBRARY---------------->
    <script src="static/js/popper.min.js"></script>

    <!--------LOADING MOMENT LIBRARY---------------->
    <script src="static/js/moment-with-locales.min.js"></script>

    <!--------LOADING BOOTSTRAP LIBRARY---------------->
    <script src="static/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="static/css/bootstrap.min.css">

    <!--------LOADING D3.JS CHARTS LIBRARY---------------->
    <!-- Load D3.js -->
    <script src="static/js/d3.v5.min.js"></script>

    <!-- Load billboard.js with style -->
    <script src="static/js/billboard.min.js"></script>
    <link rel="stylesheet" href="static/css/billboard.min.css">

    <!--------LOADING MAIN JS AND CSS---------------->
    <script type="text/javascript">
        var target = '<?= htmlentities($target) ?>';
    </script>
    <script src="static/js/ajax.js"></script>
    <script src="static/js/new_gui.js"></script>
    <script src="static/js/charts.js"></script>
    <script src="static/js/settings.js"></script>


    <link rel="stylesheet" href="static/css/new_gui.css">
    <link rel="stylesheet" href="static/css/fontawesome-all.css">

    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
<div class="app-wrapper">
    <!-- App Header -->
    <header class="header bg-dark navbar-dark">
        <nav class="navbar navbar-expand-md pl-0 pr-0">
            <a class="navbar-brand navbrand-width m-sm-0 d-none d-sm-block pl-2 pr-2" href="#">
                <img class="mx-auto d-block img-width logo-shadow" src="static/imgs/espressif.png">
            </a>
            <a class="navbar-brand d-none d-md-block m-auto" href="#">Automated Smart Meters System</a>
            <a class="navbar-brand m-auto d-md-none" href="#">ASMS</a>
            <button class="navbar-toggler mr-2" type="button" data-toggle="collapse" data-target="#sidebar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
        </nav>
    </header>
    <!-- App Sidebar -->
    <aside class="sidebar bg-dark pl-2 pr-2">
        <ul class="list-unstyled collapse d-md-block pt-1 pb-1 mb-0" id="sidebar">
            <li><a class="active" href="#MainStat" data-target="#MainStat" onclick="show_main_stats();">
                <img class="shadowfilter" src="static/imgs/mainStatistic.png">
                <span>Main Stats</span>
            </a></li>
            <li>
                <a href="#Meters" data-target="#Meters" data-toggle="collapse">
                    <img class="shadowfilter" src="static/imgs/meters.png">
                    <span>Meters</span>
                    <i class="fa fa-chevron-right carret"></i>
                </a>
                <ul class="list-unstyled collapse" id="Meters">
                    <li><a href="#Meters/Water" data-target="#Water" onclick="show_graph_rate();">
                        <img class="shadowfilter" src="static/imgs/waterMeter.png">
                        <span>Water</span>
                    </a></li>
                    <li><a href="#Meters/Electricity">
                        <img class="shadowfilter" src="static/imgs/electricityMeter.png">
                        <span>Electricity</span>
                    </a></li>
                </ul>
            </li>
            <li><a href="#Settings" data-target="#Settings" onclick="getMetersInfoFromConfig();">
                <img class="shadowfilter" src="static/imgs/settings.png">
                <span>Settings</span>
            </a></li>
        </ul>
    </aside>

    <!-- App Content -->
    <div id="content" class="content pt-2">
        <div class="container-fluid">
            <div id="MainStat" class="tab-pane active">
                <div class="row">
                    <div class="col-12">
                        <fieldset class="card">
                            <legend class="card-header">Water Rate:</legend>
                            <div class="card-body text-center">
                                <div class="row">
                                    <div class="col-12 mb-1 mt-1 text-center">
                                        <span>Get last values at: </span><span class="js_water_last_update"></span>
                                    </div>
                                    <div class="col-12 col-lg-6">
                                        <div class="card border-0 mb-md-4 mb-lg-0">
                                            <div class="card-body p-0">
                                                <h6 class="card-title cold">Cold Water</h6>
                                                <div class="table-responsive">
                                                    <table class="table table-striped cold mb-0">
                                                        <tbody>
                                                            <tr class="cold">
                                                                <td>Curr. Value:</td><td class="js_cold_curr_value"></td>
                                                            </tr>
                                                            <tr>
                                                                <td>Curr. day Rate:</td><td class="js_cold_curr_day_rate"></td>
                                                            </tr>
                                                            <tr>
                                                                <td>Curr. M. Rate:</td><td class="js_cold_curr_month_rate"></td>
                                                            </tr>
                                                            <tr>
                                                                <td>Prev. M Rate:</td><td class="js_cold_prev_month_rate"></td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-lg-6">
                                        <div class="card border-0 mb-0">
                                            <div class="card-body p-0">
                                                <h6 class="card-title hot">Hot Water</h6>
                                                <div class="table-responsive">
                                                    <table class="table table-striped hot mb-0">
                                                        <tbody>
                                                        <tr class="hot">
                                                            <td> Curr. Value:</td><td class="js_hot_curr_value"></td>
                                                        </tr>
                                                        <tr>
                                                            <td>Curr. day Rate:</td><td class="js_hot_curr_day_rate"></td>
                                                        </tr>
                                                        <tr>
                                                            <td>Curr. M. Rate:</td><td class="js_hot_curr_month_rate"></td>
                                                        </tr>
                                                        <tr>
                                                            <td>Prev. M Rate:</td><td class="js_hot_prev_month_rate"></td>
                                                        </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12">
                                        <button type="button" class="btn btn-primary" onclick="sendWaterMetersDataToPgu(); return false;">Передать показания</button>
                                    </div>
                                </div>
                            </div>
                        </fieldset>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">Electricity</div>
                            <div class="card-body"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="Water" class="tab-pane">
                <div class="row">
                    <div class="col-12">
                        <div class="card mb-0">
                            <div class="card-body p-2">
                                <div class="row">
                                    <div class="col-12">
                                        <div class="card-title m-0 p-0">
                                            <div class="btn-group btn-group-sm mb-1 ml-2">
                                                <button type="button" class="btn btn-secondary">
                                                    <span class="text-left">Day Rate:</span>
                                                </button>
                                                <button type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                    <span class="js_day"></span>
                                                    <span class="sr-only">Toggle Dropdown</span>
                                                </button>
                                                <div class="dropdown-menu">
                                                    <div class="dropdown-custom js_day_list"></div>
                                                </div>
                                            </div>
                                        </div>
                                        <hr class="cold m-0 p-0">
                                        <div id="day_rate" class="chart-container mb-4"></div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-12 col-md-6">
                                        <div class="card-title m-0 p-0">
                                            <div class="btn-group btn-group-sm mb-1 ml-2">
                                                <button type="button" class="btn btn-secondary">
                                                    <span class="text-left">Month Rate:</span>
                                                </button>
                                                <button type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                    <span class="js_month"></span>
                                                    <span class="sr-only">Toggle Dropdown</span>
                                                </button>
                                                <div class="dropdown-menu">
                                                    <div class="dropdown-custom js_month_list"></div>
                                                </div>
                                            </div>
                                        </div>
                                        <hr class="cold m-0 p-0">
                                        <div id="month_rate" class="chart-container"></div>
                                    </div>
                                    <div class="col-12 col-md-6">
                                        <div class="card-title text-center m-0 p-0 year-title-padding">Last 12 Month Rate</div>
                                        <hr class="cold m-0 p-0">
                                        <div id="last_12_month_rate" class="chart-container"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="Settings" class="tab-pane">
                <div class="row">
                    <div class="col-12">
                        <fieldset class="card">
                            <legend class="card-header">Счетчики воды:</legend>
                            <div class="card-body">
                                <form class="form-row" id="waterPayCodeForm">
                                    <div class="form-text col-12 text-center">Введите код плательщика и номер квартиры:</div>
                                    <div class="form-group col-12 col-sm-8 col-md-12 col-lg-6 mb-1">
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <div class="input-group-text justify-content-center">Код плательщика:</div>
                                            </div>
                                            <input type="text" class="form-control" id="waterPayCodeInput" placeholder="Код плательщика" name="waterPayCode">
                                        </div>
                                    </div>
                                    <div class="form-group col-12 col-sm-4 col-md-12 col-lg-3 mb-1">
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <div class="input-group-text justify-content-center">Квартира:</div>
                                            </div>
                                            <input type="text" class="form-control" id="waterFlatInput" placeholder="Квартира" name="waterFlat">
                                        </div>
                                    </div>
                                    <div class="form-group col-12 col-lg-3 mb-1">
                                        <button class="btn btn-primary btn-block" id="waterPayCodeFormGetData" onclick="getWaterMetersInfoFromPgu(); return false;">Получить данные</button>
                                    </div>
                                </form>
                                <hr/>
                                <form class="form-row" id="waterAddressForm">
                                    <div class="form-text col-12 text-center">Адрес установки счетчиков:</div>
                                    <div class="col-12 col-lg-6 align-self-center">
                                        <div class="form-group row">
                                            <label class="col-form-label col-5 align-self-center text-right">Округ/Район:</label>
                                            <div class="col-7 align-self-center">
                                                <p class="form-control-plaintext js_water_district"></p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-lg-6 align-self-center">
                                        <div class="form-group row">
                                            <label class="col-form-label col-5 align-self-center text-right">Улица:</label>
                                            <div class="col-7 align-self-center">
                                                <p class="form-control-plaintext js_water_street"></p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-sm-3">
                                        <div class="form-group row">
                                            <label class="col-form-label col-5 col-sm-6 text-right">Дом:</label>
                                            <div class="col-7 col-sm-6">
                                                <p class="form-control-plaintext js_water_house"></p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-sm-5">
                                        <div class="form-group row">
                                            <label class="col-form-label col-5 col-sm-7 text-right">Корпус:</label>
                                            <div class="col-7 col-sm-5">
                                                <p class="form-control-plaintext js_water_building"></p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-sm-4">
                                        <div class="form-group row">
                                            <label class="col-form-label col-5 col-sm-8 text-right">Квартира:</label>
                                            <div class="col-7 col-sm-4">
                                                <p class="form-control-plaintext js_water_flat"></p>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                                <hr/>
                                <form class="form-row" id="waterMetersInfo">
                                    <div class="form-text col-12 text-center">Информация о счетчиках:</div>
                                    <div class="col-12">
                                        <table class="table table-bordered table-striped table-dark table-sm" id="tableWaterMetersInfo">
                                            <thead>
                                                <tr>
                                                    <th class="meter_header"></th>
                                                    <th>ID:</th>
                                                    <th>Номер:</th>
                                                    <th>Тип:</th>
                                                    <th>Поверка:</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                            </tbody>
                                        </table>
                                    </div>
                                </form>
                                <hr>
                                <form class="form-row" id="waterSaveForm">
                                    <div class="form-group col-6">
                                        <button class="btn btn-primary btn-block" id="waterSave" onclick="saveWaterMetersInfoToConfig(); return false;">Сохранить</button>
                                    </div>
                                    <div class="form-group col-6">
                                        <button class="btn btn-primary btn-block" id="waterReset" onclick="eraseWaterMetersInfoFromConfig(); return false;">Сбросить</button>
                                    </div>
                                </form>
                            </div>
                        </fieldset>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12">
                        <fieldset class="card">
                            <legend class="card-header">Счетчик электричества:</legend>
                            <div class="card-body">
                                <form class="form-row" id="electricityMeterForm">
                                    <div class="form-text col-12 text-center">Введите номер лицевого счета и номер счетчика:</div>
                                    <div class="form-group col-12 col-sm-7 col-md-12 col-lg-5 mb-1">
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <div class="input-group-text justify-content-center">Лицевой счет:</div>
                                            </div>
                                            <input type="text" class="form-control" id="electricityPayCodeInput" placeholder="Лицевой счет" name="electricityPayCode">
                                        </div>
                                    </div>
                                    <div class="form-group col-12 col-sm-5 col-md-12 col-lg-4 mb-1">
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <div class="input-group-text justify-content-center">№ счетчика:</div>
                                            </div>
                                            <input type="text" class="form-control" id="meterID" placeholder="№ счетчика" name="meterID">
                                        </div>
                                    </div>
                                    <div class="form-group col-12 col-lg-3 mb-1">
                                        <button type="submit" class="btn btn-primary btn-block" id="electricityMeterGetData" onclick="getElectricityMeterInfoFromPgu(); return false;">Получить данные</button>
                                    </div>
                                </form>
                            </div>
                        </fieldset>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="fade modal" id="modalAlert">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title js_modal-title"></h4>
                </div>
                <div class="modal-body js_modal-body"></div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-dark" data-dismiss="modal">Ok</button>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>

